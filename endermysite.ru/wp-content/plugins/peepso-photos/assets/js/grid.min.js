!function(t){var e=function(h){var r=[{},{},{},{},{},{}],t=1,e=2,i=3;return r[2][1]={float:["left","left"],height:["100%","100%"],width:["50%","50%"]},r[2][2]={float:["",""],height:["50%","50%"],width:["100%","100%"]},r[2][3]={float:["left","left"],height:["50%","50%"],width:["50%","50%"]},r[3][1]={float:["left","left","left"],height:["100%","50%","50%"],width:["66.6%","33.3%","33.3%"]},r[3][2]={float:["","left","left"],height:["66.6%","33.3%","33.3%"],width:["100%","50%","50%"]},r[3][3]={float:["","left","left"],height:["50%","50%","50%"],width:["100%","50%","50%"]},r[4][1]={float:["left","left","left","left"],height:["100%","33.3%","33.3%","33.3%"],width:["66.6%","33.3%","33.3%","33.4%"]},r[4][2]={float:["","left","left","left"],height:["66.6%","33.3%","33.3%","33.3%"],width:["100%","33.3%","33.3%","33.3%"]},r[4][3]={float:["left","left","left","left"],height:["50%","50%","50%","50%"],width:["50%","50%","50%","50%"]},r[5][1]={float:["left","left","left","left","left"],height:["50%","50%","33.3%","33.3%","33.3%"],width:["50%","50%","33.3%","33.3%","33.3%"]},r[5][2]={float:["left","left","left","left","left"],height:["50%","50%","33.3%","33.3%","33.3%"],width:["50%","50%","33.3%","33.3%","33.3%"]},r[5][3]={float:["left","left","left","left","left"],height:["50%","50%","33.3%","33.3%","33.3%"],width:["50%","50%","33.3%","33.3%","33.3%"]},{update:function(){var t=h("[data-ps-grid=photos]");(t=t.not(function(){return h(this).data("ps-grid-initialized")})).each(h.proxy(function(t,e){(e=h(e)).data("ps-grid-initialized",!0),this._arrange(e)},this))},_arrange:function(i){var t,a=i.children("[data-ps-grid-item]"),o=a.find("img[src]");i.css({position:"relative",width:"100%",maxWidth:600,minWidth:200,maxHeight:1200,overflow:"hidden"}),t=_.map(h.makeArray(o),function(t){return t.src}),this._loadImages(t).always(h.proxy(function(){var t,e,n;1<a.length&&(t=h.makeArray(o),e=this._isPotrait(t)?1:this._isLandscape(t)?2:3,n=r[t.length][e],a.each(function(t){var e=h(this),i=n.width[t],a=n.height[t],o=n.float[t];e.css({float:o,width:i,paddingTop:a}),_.defer(function(t,e,i){var a=t.find("img");a.hasClass("ps-js-fitted")||(a.addClass("ps-js-fitted"),e/i<(a[0].naturalWidth||a[0].width)/(a[0].naturalHeight||a[0].height)?a.css({width:"auto",height:"100%"}):a.css({width:"100%",height:"auto"}))},e,parseFloat(i),parseFloat(a))})),a.show(),i.children(".ps-js-loading").remove()},this))},_isPotrait:function(t){return t=_.isArray(t)?t:[t],.5<_.filter(t,function(t){return(t.naturalWidth||t.width)/(t.naturalHeight||t.height)<.75}).length/t.length},_isLandscape:function(t){return t=_.isArray(t)?t:[t],.5<_.filter(t,function(t){var e=t.naturalWidth||t.width;return(t.naturalHeight||t.height)/e<.75}).length/t.length},_loadImage:function(o){return h.Deferred(function(t){var e=new Image;function i(){a(),t.reject(e)}function a(){e.onload=null,e.onerror=null,e.onabort=null}e.onload=function(){a(),t.resolve(e)},e.onerror=i,e.onabort=i,e.src=o}).promise()},_loadImages:function(t){var e=[];return _.isArray(t)||(t=[t]),t.forEach(h.proxy(function(t){e.push(this._loadImage(t))},this)),h.when.apply(h,e)}}}(t);peepso.photoGrid=function(){e.update()},t(function(){peepso.photoGrid(),t(window).on("load",function(){peepso.photoGrid()}),t(document).on(["ps_activitystream_loaded","ps_activitystream_append","peepso_post_edit_saved","peepso_repost_shown","peepso_repost_added"].join(" "),function(t){"ps_activitystream_append"===t.type?setTimeout(peepso.photoGrid,3e3):peepso.photoGrid()})})}(jQuery);